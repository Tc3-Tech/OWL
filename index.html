<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Rivian Technician Portal - Wiring Diagrams</title>
  
  <!-- Tailwind CSS -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  
  <!-- React and ReactDOM -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  
  <!-- Babel for JSX support -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.7/babel.min.js"></script>
  
  <!-- Additional styles -->
  <style>
    html, body, #root {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    }
    
    * {
      box-sizing: border-box;
    }
    
    .tooltip {
      position: relative;
      display: inline-block;
    }
    
    .tooltip .tooltip-text {
      visibility: hidden;
      width: 200px;
      background-color: #555;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 5px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      margin-left: -100px;
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .tooltip .tooltip-text::after {
      content: "";
      position: absolute;
      top: 100%;
      left: 50%;
      margin-left: -5px;
      border-width: 5px;
      border-style: solid;
      border-color: #555 transparent transparent transparent;
    }
    
    .tooltip:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
    }
    
    .fade-in {
      animation: fadeIn 0.3s;
    }
    
    @keyframes fadeIn {
      0% { opacity: 0; }
      100% { opacity: 1; }
    }
    
    .connector-highlight {
      stroke: #ff3300;
      stroke-width: 3;
      filter: drop-shadow(0 0 5px rgba(255, 51, 0, 0.7));
      animation: pulse 1.5s infinite;
    }
    
    @keyframes pulse {
      0% { opacity: 0.6; }
      50% { opacity: 1; }
      100% { opacity: 0.6; }
    }
    
    .wiring-zoom {
      transition: transform 0.3s ease;
    }
    
    .wiring-zoom:hover {
      transform: scale(1.05);
    }
    
    /* Circuit trace animation */
    .circuit-trace {
      stroke-dasharray: 10;
      animation: dash 30s linear infinite;
    }
    
    @keyframes dash {
      to {
        stroke-dashoffset: 1000;
      }
    }
    
    /* Path highlight animation */
    .path-highlight {
      stroke-dasharray: 20;
      animation: flow 1.5s linear infinite;
    }
    
    @keyframes flow {
      to {
        stroke-dashoffset: 40;
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <!-- Your React component -->
  <script type="text/babel">
    const TechnicianPortal = () => {
      // State hooks for interactivity
      const [activeTab, setActiveTab] = React.useState("resources");
      const [selectedCategory, setSelectedCategory] = React.useState("Repair Procedures");
      const [showSuccessMessage, setShowSuccessMessage] = React.useState(false);
      const [expandedNode, setExpandedNode] = React.useState(null);
      const [showWiringDetail, setShowWiringDetail] = React.useState(false);
      const [selectedComponent, setSelectedComponent] = React.useState(null);
      const [highlightedCircuit, setHighlightedCircuit] = React.useState(null);
      const [viewMode, setViewMode] = React.useState("overview"); // "overview", "detail", "connector"
      
      // Sample data for demonstration
      const workOrderData = {
        orderNumber: "WO-27491",
        vehicle: "R1T",
        vin: "7FTTW1CV3NLB51289",
        reportedIssue: "Vehicle experiencing loss of power during acceleration",
        diagnosedProblem: "Drive Unit Replacement Required",
        technicianAssigned: "Alex Rodriguez"
      };
      
      // Handle tab click
      const handleTabClick = (tab) => {
        setActiveTab(tab);
        // Reset wiring view if changing tabs
        if (tab !== "resources") {
          setShowWiringDetail(false);
        }
      };
      
      // Handle category selection
      const handleCategoryClick = (category) => {
        setSelectedCategory(category);
        // Reset wiring view if changing categories
        if (category !== "Wiring Design Portal") {
          setShowWiringDetail(false);
        }
      };
      
      // Handle apply to documentation
      const handleApplyToDocumentation = () => {
        setShowSuccessMessage(true);
        setTimeout(() => {
          setShowSuccessMessage(false);
        }, 3000);
      };
      
      // Handle node click
      const handleNodeClick = (nodeId) => {
        if (expandedNode === nodeId) {
          setExpandedNode(null);
        } else {
          setExpandedNode(nodeId);
        }
      };
      
      // Handle wiring diagram click
      const handleWiringDiagramClick = () => {
        setShowWiringDetail(true);
        setSelectedCategory("Wiring Design Portal");
        setActiveTab("resources");
        setViewMode("overview");
      };
      
      // Handle component selection in wiring diagram
      const handleComponentSelect = (component) => {
        setSelectedComponent(component);
        setViewMode("detail");
      };
      
      // Handle connector detail view
      const handleConnectorView = (connector) => {
        setHighlightedCircuit(connector);
        setViewMode("connector");
      };
      
      // Handle back to overview
      const handleBackToOverview = () => {
        setViewMode("overview");
        setSelectedComponent(null);
        setHighlightedCircuit(null);
      };
      
      // Resource categories data
      const categories = [
        "Repair Procedures",
        "Service Procedures (RiDE)",
        "Wiring Design Portal",
        "QUEST Nodes",
        "Theory of Operations",
        "Parts Information",
        "Tool Requirements"
      ];
      
      // Wiring components data
      const wiringComponents = [
        { 
          id: "hvmc", 
          name: "High Voltage Main Connector",
          description: "Primary high voltage connection to the Drive Unit",
          pins: 6,
          voltage: "400V DC",
          location: "Front of the Drive Unit",
          connectors: ["HV_CONN_1", "HV_CONN_2", "HV_CONN_3"]
        },
        { 
          id: "lvcc", 
          name: "Low Voltage Control Connector",
          description: "Communication and control signals for the Drive Unit",
          pins: 24,
          voltage: "12V DC",
          location: "Side of the Drive Unit",
          connectors: ["LV_CTRL_1", "LV_CTRL_2", "LV_SHIELD"]
        },
        { 
          id: "thsc", 
          name: "Thermal System Connector",
          description: "Temperature sensors and coolant flow monitoring",
          pins: 8,
          voltage: "5V DC",
          location: "Rear of the Drive Unit",
          connectors: ["TEMP_1", "TEMP_2", "FLOW_SENSE"]
        },
        { 
          id: "encb", 
          name: "Encoder/Brake Connector",
          description: "Position feedback and electric braking control",
          pins: 12,
          voltage: "12V DC",
          location: "Top of the Drive Unit",
          connectors: ["POS_SENSE", "BRAKE_CTRL", "SPEED_SENSE"]
        }
      ];
      
      // Connector pinout data
      const connectorPinouts = {
        "HV_CONN_1": [
          { pin: 1, color: "Orange", function: "HV+ Power Input", rating: "400V/350A" },
          { pin: 2, color: "Orange/Black", function: "HV+ Sense", rating: "400V/1A" }
        ],
        "HV_CONN_2": [
          { pin: 1, color: "Blue", function: "HV- Power Return", rating: "400V/350A" },
          { pin: 2, color: "Blue/Black", function: "HV- Sense", rating: "400V/1A" }
        ],
        "HV_CONN_3": [
          { pin: 1, color: "Green/Yellow", function: "Chassis Ground", rating: "0V/350A" },
          { pin: 2, color: "Green", function: "Ground Sense", rating: "0V/1A" }
        ],
        "LV_CTRL_1": [
          { pin: 1, color: "Red", function: "12V Supply", rating: "12V/5A" },
          { pin: 2, color: "Brown", function: "Ground", rating: "0V/5A" },
          { pin: 3, color: "White/Blue", function: "CAN High", rating: "2.5V/0.1A" },
          { pin: 4, color: "White/Brown", function: "CAN Low", rating: "2.5V/0.1A" }
        ],
        "LV_CTRL_2": [
          { pin: 1, color: "Purple", function: "Torque Request", rating: "0-5V/0.01A" },
          { pin: 2, color: "Yellow", function: "Direction Control", rating: "0-5V/0.01A" },
          { pin: 3, color: "Orange", function: "Regen Control", rating: "0-5V/0.01A" },
          { pin: 4, color: "Gray", function: "Fault Output", rating: "12V/0.1A" }
        ]
      };
      
      // Documentation tab content
      const DocumentationContent = () => (
        <div className="bg-white p-4 rounded shadow-md">
          <h2 className="text-xl font-bold border-b pb-2 mb-4">Work Order Documentation</h2>
          
          <div className="space-y-4">
            <div>
              <h3 className="font-bold text-lg">Vehicle Information</h3>
              <div className="grid grid-cols-2 gap-4 mt-2">
                <div className="p-2 border rounded bg-gray-50">
                  <p className="text-sm font-semibold">Vehicle</p>
                  <p className="text-sm">{workOrderData.vehicle}</p>
                </div>
                <div className="p-2 border rounded bg-gray-50">
                  <p className="text-sm font-semibold">VIN</p>
                  <p className="text-sm">{workOrderData.vin}</p>
                </div>
                <div className="p-2 border rounded bg-gray-50">
                  <p className="text-sm font-semibold">Mileage</p>
                  <p className="text-sm">4,872 mi</p>
                </div>
                <div className="p-2 border rounded bg-gray-50">
                  <p className="text-sm font-semibold">Build Date</p>
                  <p className="text-sm">11/2024</p>
                </div>
              </div>
            </div>
            
            <div>
              <h3 className="font-bold text-lg">Customer Information</h3>
              <div className="p-3 border rounded mt-2">
                <p className="text-sm"><span className="font-semibold">Customer Name:</span> John Doe</p>
                <p className="text-sm"><span className="font-semibold">Contact:</span> (555) 123-4567</p>
                <p className="text-sm"><span className="font-semibold">Notes:</span> Customer reported issue only occurs during hard acceleration</p>
              </div>
            </div>
            
            <div>
              <h3 className="font-bold text-lg">Technician Notes</h3>
              <textarea className="w-full p-2 border rounded mt-2 h-32" placeholder="Enter your repair notes here..."></textarea>
              <div className="flex justify-end mt-2">
                <button className="bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">Save Notes</button>
              </div>
            </div>
          </div>
        </div>
      );
      
      // Notes tab content
      const NotesContent = () => (
        <div className="bg-white p-4 rounded shadow-md">
          <h2 className="text-xl font-bold border-b pb-2 mb-4">Technical Notes</h2>
          
          <div className="space-y-4">
            <div>
              <h3 className="font-bold text-lg">Service Bulletin Updates</h3>
              <div className="mt-2 border rounded p-3 bg-blue-50">
                <p className="text-sm font-semibold text-blue-800">SB-2025-042: Drive Unit High Voltage Connector Torque Update (May 1, 2025)</p>
                <p className="text-sm mt-1">Updated torque specifications for high voltage connectors on Drive Units manufactured before March 2025. Apply 8.5 Nm of torque to primary drive unit connectors.</p>
              </div>
            </div>
            
            <div>
              <h3 className="font-bold text-lg">Personal Notes</h3>
              <div className="grid grid-cols-1 gap-2 mt-2">
                <div className="border p-2 rounded bg-yellow-50">
                  <p className="text-sm font-semibold">Note from April 15, 2025</p>
                  <p className="text-sm text-gray-700">Remember to check the coolant level before operating the vehicle after drive unit replacement. New units come dry.</p>
                </div>
                <div className="border p-2 rounded bg-yellow-50">
                  <p className="text-sm font-semibold">Note from March 22, 2025</p>
                  <p className="text-sm text-gray-700">High voltage connector pin 4 sometimes shows high resistance. Clean thoroughly before connection.</p>
                </div>
              </div>
              <div className="mt-2">
                <input type="text" className="w-full p-2 border rounded" placeholder="Add a new note..."/>
                <div className="flex justify-end mt-2">
                  <button className="bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">Add Note</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      );
      
      // Drive Unit Wiring Overview Component
      const WiringOverview = () => (
        <div className="bg-white p-4 rounded shadow-md">
          <div className="flex justify-between items-center border-b pb-2 mb-4">
            <h2 className="text-xl font-bold">R1T Drive Unit Wiring Diagrams</h2>
            <div className="flex space-x-2">
              <button 
                className="bg-gray-200 text-gray-700 px-2 py-1 rounded text-xs font-semibold hover:bg-gray-300"
                onClick={() => alert("Downloading PDF version of wiring diagrams")}
              >
                Download PDF
              </button>
              <button 
                className="bg-blue-600 text-white px-2 py-1 rounded text-xs font-semibold hover:bg-blue-700"
                onClick={() => alert("Printing wiring diagrams")}
              >
                Print
              </button>
            </div>
          </div>
          
          <div className="mb-4">
            <p className="text-sm text-gray-600">Select a connector type below to view detailed pinout and circuit diagrams for the R1T Drive Unit. All diagrams are specific to vehicle with VIN: {workOrderData.vin}</p>
          </div>
          
          <div className="grid grid-cols-2 gap-4 mb-6">
            {wiringComponents.map(component => (
              <div 
                key={component.id}
                className="border rounded p-3 cursor-pointer hover:bg-blue-50 hover:border-blue-300 transition-colors wiring-zoom"
                onClick={() => handleComponentSelect(component)}
              >
                <div className="flex justify-between items-start">
                  <h3 className="font-bold text-blue-700">{component.name}</h3>
                  <span className="bg-gray-200 text-gray-700 px-2 py-0.5 rounded-full text-xs">{component.pins} pins</span>
                </div>
                <p className="text-sm text-gray-600 mt-1">{component.description}</p>
                <p className="text-xs text-gray-500 mt-2">Location: {component.location}</p>
                <p className="text-xs text-gray-500">Voltage: {component.voltage}</p>
              </div>
            ))}
          </div>
          
          <div className="border-t pt-4">
            <h3 className="font-bold text-lg mb-3">Drive Unit Wiring Overview</h3>
            
            <div className="bg-gray-100 p-2 rounded relative" style={{height: "300px"}}>
              {/* This is a simplified SVG representation of the drive unit wiring */}
              <svg width="100%" height="100%" viewBox="0 0 800 300" xmlns="http://www.w3.org/2000/svg">
                {/* Drive Unit Main Body */}
                <rect x="250" y="50" width="300" height="200" rx="10" fill="#e2e8f0" stroke="#64748b" strokeWidth="2" />
                <text x="400" y="150" fontSize="16" fontWeight="bold" textAnchor="middle" fill="#334155">Drive Unit</text>
                
                {/* High Voltage Main Connector */}
                <rect 
                  x="210" y="100" width="40" height="30" fill="#fecaca" stroke="#ef4444" strokeWidth="2" 
                  className="cursor-pointer"
                  onClick={() => handleComponentSelect(wiringComponents.find(c => c.id === "hvmc"))}
                />
                <text x="230" y="90" fontSize="10" textAnchor="middle" fill="#ef4444">HV Main</text>
                <path d="M100 115 L210 115" stroke="#ef4444" strokeWidth="3" className="circuit-trace" />
                <text x="150" y="110" fontSize="10" textAnchor="middle" fill="#ef4444">400V DC</text>
                
                {/* Low Voltage Control Connector */}
                <rect 
                  x="280" y="250" width="30" height="20" fill="#bfdbfe" stroke="#3b82f6" strokeWidth="2" 
                  className="cursor-pointer"
                  onClick={() => handleComponentSelect(wiringComponents.find(c => c.id === "lvcc"))}
                />
                <text x="295" y="280" fontSize="10" textAnchor="middle" fill="#3b82f6">LV Control</text>
                <path d="M295 270 L295 340" stroke="#3b82f6" strokeWidth="2" className="circuit-trace" />
                <text x="295" y="320" fontSize="10" textAnchor="middle" fill="#3b82f6">12V Control</text>
                
                {/* Thermal System Connector */}
                <rect 
                  x="550" y="120" width="40" height="20" fill="#bbf7d0" stroke="#22c55e" strokeWidth="2" 
                  className="cursor-pointer"
                  onClick={() => handleComponentSelect(wiringComponents.find(c => c.id === "thsc"))}
                />
                <text x="570" y="110" fontSize="10" textAnchor="middle" fill="#22c55e">Thermal</text>
                <path d="M590 130 L700 130" stroke="#22c55e" strokeWidth="2" className="circuit-trace" />
                <text x="650" y="125" fontSize="10" textAnchor="middle" fill="#22c55e">Temp Sensors</text>
                
                {/* Encoder/Brake Connector */}
                <rect 
                  x="480" y="50" width="30" height="20" fill="#fef08a" stroke="#ca8a04" strokeWidth="2" 
                  className="cursor-pointer"
                  onClick={() => handleComponentSelect(wiringComponents.find(c => c.id === "encb"))}
                />
                <text x="495" y="40" fontSize="10" textAnchor="middle" fill="#ca8a04">Encoder</text>
                <path d="M495 50 L495 10" stroke="#ca8a04" strokeWidth="2" className="circuit-trace" />
                <text x="495" y="25" fontSize="10" textAnchor="middle" fill="#ca8a04">Position</text>
                
                {/* Vehicle Outline */}
                <path d="M50 50 L100 30 L700 30 L750 50 L750 200 L700 220 L100 220 L50 200 Z" fill="none" stroke="#94a3b8" strokeWidth="1" strokeDasharray="5,5" />
                <text x="400" y="225" fontSize="12" textAnchor="middle" fill="#64748b">Vehicle Chassis</text>
              </svg>
            </div>
            
            <div className="mt-4 text-sm text-gray-600">
              <p><span className="font-semibold">Note:</span> The Drive Unit connects to four primary connector sets. Click on any connector in the diagram above to see detailed pinout information.</p>
              <p className="mt-2"><span className="font-semibold">Recent Updates:</span> Service Bulletin SB-2025-042 updated the torque specifications for high voltage connectors. Refer to TSB for specifics.</p>
            </div>
          </div>
        </div>
      );
      
      // Component Detail View
      const ComponentDetailView = ({ component }) => (
        <div className="bg-white p-4 rounded shadow-md">
          <div className="flex justify-between items-center">
            <div>
              <button 
                className="text-blue-600 font-semibold flex items-center mb-2" 
                onClick={handleBackToOverview}
              >
                <svg className="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M15 19l-7-7 7-7"></path>
                </svg>
                Back to Wiring Overview
              </button>
              <h2 className="text-xl font-bold">{component.name}</h2>
              <p className="text-sm text-gray-600 mt-1">{component.description}</p>
            </div>
            <span className="bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm">{component.voltage} | {component.pins} Pins</span>
          </div>
          
          <div className="border-t border-b my-4 py-4">
            <h3 className="font-bold text-lg mb-3">Connector Location</h3>
            <div className="bg-gray-100 p-2 rounded relative" style={{height: "200px"}}>
              {/* Simplified SVG of drive unit with highlighted connector */}
              <svg width="100%" height="100%" viewBox="0 0 600 200" xmlns="http://www.w3.org/2000/svg">
                {/* Drive Unit Main Body */}
                <rect x="150" y="25" width="300" height="150" rx="10" fill="#e2e8f0" stroke="#64748b" strokeWidth="2" />
                <text x="300" y="100" fontSize="16" fontWeight="bold" textAnchor="middle" fill="#334155">Drive Unit</text>
                
                {/* Connector Placement - conditionally change position based on component */}
                {component.id === "hvmc" && (
                  <>
                    <rect x="110" y="75" width="40" height="30" fill="#fecaca" stroke="#ef4444" strokeWidth="3" className="connector-highlight" />
                    <text x="130" y="65" fontSize="12" fontWeight="bold" textAnchor="middle" fill="#ef4444">HV Main</text>
                    <path d="M50 90 L110 90" stroke="#ef4444" strokeWidth="3" className="path-highlight" />
                  </>
                )}
                
                {component.id === "lvcc" && (
                  <>
                    <rect x="210" y="175" width="30" height="20" fill="#bfdbfe" stroke="#3b82f6" strokeWidth="3" className="connector-highlight" />
                    <text x="225" y="205" fontSize="12" fontWeight="bold" textAnchor="middle" fill="#3b82f6">LV Control</text>
                    <path d="M225 175 L225 220" stroke="#3b82f6" strokeWidth="3" className="path-highlight" />
                  </>
                )}
                
                {component.id === "thsc" && (
                  <>
                    <rect x="450" y="85" width="40" height="20" fill="#bbf7d0" stroke="#22c55e" strokeWidth="3" className="connector-highlight" />
                    <text x="470" y="75" fontSize="12" fontWeight="bold" textAnchor="middle" fill="#22c55e">Thermal</text>
                    <path d="M490 95 L550 95" stroke="#22c55e" strokeWidth="3" className="path-highlight" />
                  </>
                )}
                
                {component.id === "encb" && (
                  <>
                    <rect x="370" y="25" width="30" height="20" fill="#fef08a" stroke="#ca8a04" strokeWidth="3" className="connector-highlight" />
                    <text x="385" y="15" fontSize="12" fontWeight="bold" textAnchor="middle" fill="#ca8a04">Encoder</text>
                    <path d="M385 25 L385 5" stroke="#ca8a04" strokeWidth="3" className="path-highlight" />
                  </>
                )}
              </svg>
            </div>
          </div>
          
          <div className="mb-4">
            <h3 className="font-bold text-lg mb-3">Connector Details</h3>
            <div className="grid grid-cols-1 gap-4">
              {component.connectors.map(connector => (
                <div 
                  key={connector} 
                  className="border p-3 rounded hover:bg-blue-50 cursor-pointer transition-colors"
                  onClick={() => handleConnectorView(connector)}
                >
                  <div className="flex justify-between items-center">
                    <h4 className="font-semibold text-blue-700">{connector}</h4>
                    <span className="text-xs text-gray-500">
                      {connectorPinouts[connector] ? `${connectorPinouts[connector].length} pins` : 'Details available'}
                    </span>
                  </div>
                  <p className="text-sm text-gray-600 mt-1">
                    {connector.includes("HV") ? "High Voltage Connection" : 
                     connector.includes("LV") ? "Low Voltage Control" :
                     connector.includes("TEMP") ? "Temperature Sensor" :
                     connector.includes("POS") ? "Position Encoder" : "Control Connection"}
                  </p>
                  <p className="text-xs text-blue-600 mt-2 underline">Click to view pinout details</p>
                </div>
              ))}
            </div>
          </div>
          
          <div className="border-t pt-4">
            <h3 className="font-bold text-lg mb-2">Technical Notes</h3>
            <ul className="text-sm text-gray-600 space-y-1 list-disc pl-5">
              <li>Always disconnect 12V battery before working with drive unit connectors</li>
              <li>High voltage connectors require HV-certified technicians</li>
              <li>Check for water intrusion or corrosion in all connectors</li>
              <li>Apply dielectric grease to all connections when reassembling</li>
              {component.id === "hvmc" && <li className="text-red-600 font-semibold">Follow SB-2025-042 for updated torque specifications</li>}
            </ul>
          </div>
        </div>
      );
      
      // Connector Pinout Detail View
      const ConnectorPinoutView = ({ connector }) => {
        const pins = connectorPinouts[connector] || [];
        
        return (
          <div className="bg-white p-4 rounded shadow-md">
            <div>
              <button 
                className="text-blue-600 font-semibold flex items-center mb-2" 
                onClick={() => setViewMode("detail")}
              >
                <svg className="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M15 19l-7-7 7-7"></path>
                </svg>
                Back to Connector Selection
              </button>
              <h2 className="text-xl font-bold">{connector} Pinout</h2>
              <p className="text-sm text-gray-600 mt-1">
                {connector.includes("HV") ? "High Voltage Connection" : 
                 connector.includes("LV") ? "Low Voltage Control" :
                 connector.includes("TEMP") ? "Temperature Sensor" :
                 connector.includes("POS") ? "Position Encoder" : "Control Connection"}
              </p>
            </div>
            
            <div className="border-t border-b my-4 py-4">
              <div className="flex justify-between items-center mb-4">
                <h3 className="font-bold text-lg">Pin Specifications</h3>
                <button 
                  className="bg-blue-600 text-white px-3 py-1 rounded text-xs hover:bg-blue-700"
                  onClick={() => alert(`Testing continuity for ${connector}`)}
                >
                  Test Continuity
                </button>
              </div>
              
              <div className="bg-gray-100 p-3 rounded mb-4" style={{height: "180px"}}>
                {/* Pin Diagram Visualization */}
                <svg width="100%" height="100%" viewBox="0 0 400 150" xmlns="http://www.w3.org/2000/svg">
                  {/* Connector housing */}
                  <rect x="100" y="20" width="200" height="110" rx="5" fill="#e2e8f0" stroke="#64748b" strokeWidth="2" />
                  
                  {/* Connector label */}
                  <text x="200" y="15" fontSize="12" fontWeight="bold" textAnchor="middle" fill="#1e3a8a">{connector}</text>
                  
                  {/* Draw pins based on pinout data */}
                  {pins.map((pin, index) => {
                    const pinX = 130 + (index * 50);
                    return (
                      <g key={index}>
                        <circle 
                          cx={pinX} 
                          cy="75" 
                          r="15" 
                          fill="#f1f5f9" 
                          stroke={pin.color.toLowerCase() || "#000"} 
                          strokeWidth="2" 
                        />
                        <text x={pinX} y="79" fontSize="10" fontWeight="bold" textAnchor="middle" fill="#334155">
                          {pin.pin}
                        </text>
                        <text x={pinX} y="110" fontSize="8" textAnchor="middle" fill="#64748b">
                          {pin.color}
                        </text>
                        <path 
                          d={`M${pinX} 90 L${pinX} 130`} 
                          stroke={pin.color.toLowerCase() || "#000"} 
                          strokeWidth="2" 
                        />
                      </g>
                    );
                  })}
                </svg>
              </div>
              
              <table className="min-w-full mt-2 border">
                <thead>
                  <tr className="bg-gray-100">
                    <th className="p-2 text-left text-sm">Pin</th>
                    <th className="p-2 text-left text-sm">Color</th>
                    <th className="p-2 text-left text-sm">Function</th>
                    <th className="p-2 text-left text-sm">Rating</th>
                  </tr>
                </thead>
                <tbody>
                  {pins.map((pin, index) => (
                    <tr key={index} className="border-t">
                      <td className="p-2 text-sm">{pin.pin}</td>
                      <td className="p-2 text-sm">
                        <div className="flex items-center">
                          <div 
                            className="w-3 h-3 rounded-full mr-2" 
                            style={{ 
                              backgroundColor: pin.color.toLowerCase().includes('orange') ? '#f97316' :
                                               pin.color.toLowerCase().includes('blue') ? '#3b82f6' :
                                               pin.color.toLowerCase().includes('green') ? '#22c55e' :
                                               pin.color.toLowerCase().includes('red') ? '#ef4444' :
                                               pin.color.toLowerCase().includes('brown') ? '#92400e' :
                                               pin.color.toLowerCase().includes('white') ? '#f8fafc' :
                                               pin.color.toLowerCase().includes('yellow') ? '#eab308' :
                                               pin.color.toLowerCase().includes('purple') ? '#a855f7' :
                                               pin.color.toLowerCase().includes('gray') ? '#64748b' : '#000000',
                              border: pin.color.toLowerCase().includes('white') ? '1px solid #94a3b8' : 'none'
                            }}
                          ></div>
                          {pin.color}
                        </div>
                      </td>
                      <td className="p-2 text-sm">{pin.function}</td>
                      <td className="p-2 text-sm">{pin.rating}</td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
            
            <div>
              <h3 className="font-bold text-lg mb-2">Circuit Information</h3>
              <div className="text-sm space-y-2">
                <div className="p-2 bg-yellow-50 border border-yellow-200 rounded">
                  <p className="font-semibold text-yellow-800">Diagnostic Information</p>
                  <p className="text-gray-700">Check for continuity between {connector} and the Vehicle Control Module. Expected resistance should be less than 0.5 ohms.</p>
                </div>
                
                <div className="p-2 bg-blue-50 border border-blue-200 rounded">
                  <p className="font-semibold text-blue-800">Common Issues</p>
                  <ul className="list-disc pl-5 text-gray-700">
                    <li>Corrosion on pins can cause intermittent connection</li>
                    <li>Terminal backout from improper installation</li>
                    <li>Damage to seals can allow water intrusion</li>
                  </ul>
                </div>
              </div>
              
              <div className="flex justify-end mt-4 space-x-2">
                <button 
                  className="bg-gray-200 text-gray-700 px-3 py-1 rounded text-sm hover:bg-gray-300"
                  onClick={() => alert(`Downloading wiring diagram for ${connector}`)}
                >
                  Download Diagram
                </button>
                <button 
                  className="bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700"
                  onClick={() => alert(`Opening interactive troubleshooting for ${connector}`)}
                >
                  Troubleshoot Circuit
                </button>
              </div>
            </div>
          </div>
        );
      };
      
      // Resources tab content - Choose between normal view and wiring view
      const ResourcesContent = () => {
        if (showWiringDetail && selectedCategory === "Wiring Design Portal") {
          if (viewMode === "overview") {
            return <WiringOverview />;
          } else if (viewMode === "detail" && selectedComponent) {
            return <ComponentDetailView component={selectedComponent} />;
          } else if (viewMode === "connector" && highlightedCircuit) {
            return <ConnectorPinoutView connector={highlightedCircuit} />;
          }
        }
        
        return (
          <div className="bg-white p-4 rounded shadow-md">
            <h2 className="text-xl font-bold border-b pb-2 mb-4">Drive Unit Replacement Procedure</h2>
            
            <div className="flex justify-between mb-4">
              <span className="bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm">Estimated Time: 4.5 hours</span>
              <span className="bg-green-100 text-green-800 px-2 py-1 rounded text-sm">Parts In Stock</span>
            </div>
            
            <div className="space-y-4">
              <div>
                <h3 className="font-bold text-lg">Required Resources:</h3>
                <div className="grid grid-cols-2 gap-2 mt-2">
                  <a href="#" className="flex items-center p-2 border rounded hover:bg-blue-50">
                    <svg className="w-5 h-5 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                    Complete Procedure Document
                  </a>
                  <a href="#" className="flex items-center p-2 border rounded hover:bg-blue-50">
                    <svg className="w-5 h-5 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                    RiDE Diagnostics
                  </a>
                  <a 
                    href="#" 
                    className="flex items-center p-2 border rounded hover:bg-blue-50 bg-blue-100"
                    onClick={handleWiringDiagramClick}
                  >
                    <svg className="w-5 h-5 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M10 21h7a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v11m0 5l4.879-4.879m0 0a3 3 0 104.243-4.242 3 3 0 00-4.243 4.242z"></path></svg>
                    Wiring Diagrams
                  </a>
                  <a href="#" className="flex items-center p-2 border rounded hover:bg-blue-50">
                    <svg className="w-5 h-5 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg>
                    Parts Catalog
                  </a>
                </div>
              </div>
              
              <div>
                <h3 className="font-bold text-lg">QUEST Node History:</h3>
                <div className="mt-2 border rounded p-3 bg-gray-50">
                  <p className="text-sm"><span className="font-semibold">3 relevant QUEST nodes found</span> for Drive Unit Replacement on R1T</p>
                  <ul className="mt-2 space-y-1">
                    <li 
                      className="text-sm text-blue-600 hover:underline cursor-pointer" 
                      onClick={() => handleNodeClick("QUEST-2189")}
                    >
                      • QUEST-2189: Drive Unit Noise Investigation (April 2025)
                      {expandedNode === "QUEST-2189" && (
                        <div className="mt-2 p-2 bg-blue-50 rounded text-gray-800 fade-in">
                          <p className="text-xs">Investigation found that Drive Units built before March 2025 may exhibit noise during acceleration due to internal gear mesh tolerance. Replacement is recommended if noise is accompanied by power loss.</p>
                        </div>
                      )}
                    </li>
                    <li 
                      className="text-sm text-blue-600 hover:underline cursor-pointer" 
                      onClick={() => handleNodeClick("QUEST-1854")}
                    >
                      • QUEST-1854: Drive Unit Replacement After Water Exposure (Feb 2025)
                      {expandedNode === "QUEST-1854" && (
                        <div className="mt-2 p-2 bg-blue-50 rounded text-gray-800 fade-in">
                          <p className="text-xs">Drive units exposed to deep water may show delayed failure symptoms. Always check event logs for water detection warnings and inspect HV connector seals.</p>
                        </div>
                      )}
                    </li>
                    <li 
                      className="text-sm text-blue-600 hover:underline cursor-pointer" 
                      onClick={() => handleNodeClick("QUEST-1677")}
                    >
                      • QUEST-1677: Drive Unit Connector Failure Analysis (Jan 2025)
                      {expandedNode === "QUEST-1677" && (
                        <div className="mt-2 p-2 bg-blue-50 rounded text-gray-800 fade-in">
                          <p className="text-xs">High voltage connectors may show intermittent connection causing power loss. Updated connector design implemented in service kits after January 2025.</p>
                        </div>
                      )}
                    </li>
                  </ul>
                </div>
              </div>
              
              <div>
                <h3 className="font-bold text-lg">Parts Required:</h3>
                <table className="min-w-full mt-2 border">
                  <thead>
                    <tr className="bg-gray-100">
                      <th className="p-2 text-left text-sm">Part Number</th>
                      <th className="p-2 text-left text-sm">Description</th>
                      <th className="p-2 text-left text-sm">Quantity</th>
                      <th className="p-2 text-left text-sm">Status</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr className="border-t">
                      <td className="p-2 text-sm">RVN-DU-2572-A</td>
                      <td className="p-2 text-sm">Drive Unit Assembly - R1T</td>
                      <td className="p-2 text-sm">1</td>
                      <td className="p-2 text-sm"><span className="bg-green-100 text-green-800 px-2 py-0.5 rounded-full text-xs">In Stock</span></td>
                    </tr>
                    <tr className="border-t">
                      <td className="p-2 text-sm">RVN-MT-0582-B</td>
                      <td className="p-2 text-sm">Mounting Hardware Kit</td>
                      <td className="p-2 text-sm">1</td>
                      <td className="p-2 text-sm"><span className="bg-green-100 text-green-800 px-2 py-0.5 rounded-full text-xs">In Stock</span></td>
                    </tr>
                    <tr className="border-t">
                      <td className="p-2 text-sm">RVN-CN-1024-A</td>
                      <td className="p-2 text-sm">High Voltage Connector Set</td>
                      <td className="p-2 text-sm">1</td>
                      <td className="p-2 text-sm"><span className="bg-green-100 text-green-800 px-2 py-0.5 rounded-full text-xs">In Stock</span></td>
                    </tr>
                    <tr className="border-t">
                      <td className="p-2 text-sm">RVN-CL-0472-A</td>
                      <td className="p-2 text-sm">Coolant - EV Grade (1L)</td>
                      <td className="p-2 text-sm">4</td>
                      <td className="p-2 text-sm"><span className="bg-green-100 text-green-800 px-2 py-0.5 rounded-full text-xs">In Stock</span></td>
                    </tr>
                  </tbody>
                </table>
              </div>
              
              <div>
                <h3 className="font-bold text-lg">Special Tools Required:</h3>
                <div className="grid grid-cols-2 gap-2 mt-2">
                  <div className="border p-2 rounded bg-gray-50 tooltip">
                    <p className="text-sm font-semibold">RVN-TOOL-DU-LIFT</p>
                    <p className="text-xs text-gray-600">Drive Unit Lifting Fixture</p>
                    <p className="text-xs mt-1"><span className="text-green-600">✓</span> Available in Bay 3</p>
                    <span className="tooltip-text">Required for safe removal and installation of the drive unit. Rated for 250kg capacity.</span>
                  </div>
                  <div className="border p-2 rounded bg-gray-50 tooltip">
                    <p className="text-sm font-semibold">RVN-TOOL-HV-KIT</p>
                    <p className="text-xs text-gray-600">High Voltage Safety Kit</p>
                    <p className="text-xs mt-1"><span className="text-green-600">✓</span> Available in Main Tool Crib</p>
                    <span className="tooltip-text">Contains insulated gloves, HV testing equipment, and safety lockout tools.</span>
                  </div>
                </div>
              </div>
              
              <div className="border-t pt-4 mt-4">
                <h3 className="font-bold text-lg">Documentation Auto-Fill:</h3>
                <div className="bg-yellow-50 p-3 rounded border border-yellow-200 mt-2">
                  <p className="text-sm"><span className="font-semibold">Suggested Cause:</span> Drive unit internal fault causing power loss during acceleration</p>
                  <p className="text-sm mt-2"><span className="font-semibold">Suggested Correction:</span> Replaced drive unit assembly and performed calibration via RiDE tool. Verified proper operation through test drive.</p>
                  <button 
                    onClick={handleApplyToDocumentation} 
                    className="mt-2 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700"
                  >
                    Apply to Documentation
                  </button>
                  {showSuccessMessage && (
                    <div className="mt-2 p-2 bg-green-100 text-green-800 rounded fade-in">
                      Applied to documentation successfully!
                    </div>
                  )}
                </div>
              </div>
            </div>
          </div>
        );
      };
      
      return (
        <div className="flex flex-col h-screen bg-gray-100">
          {/* Header with Rivian branding */}
          <header className="bg-blue-900 text-white p-4">
            <div className="flex justify-between items-center">
              <div className="flex items-center space-x-2">
                <div className="font-bold text-xl">Rivian</div>
                <div className="text-sm">Tech Resource Assistant</div>
              </div>
              <div className="text-sm">
                Technician: {workOrderData.technicianAssigned} | {new Date().toLocaleDateString()}
              </div>
            </div>
          </header>
          
          {/* Work Order Info Banner */}
          <div className="bg-white p-4 shadow-md">
            <div className="flex justify-between">
              <div>
                <h1 className="text-xl font-bold">Work Order: {workOrderData.orderNumber}</h1>
                <p className="text-sm text-gray-600">
                  {workOrderData.vehicle} | VIN: {workOrderData.vin}
                </p>
              </div>
              <div className="bg-yellow-100 p-2 rounded">
                <p className="font-semibold">Diagnosed Issue:</p>
                <p className="text-red-600 font-bold">{workOrderData.diagnosedProblem}</p>
              </div>
            </div>
            <p className="mt-2"><span className="font-semibold">Reported Issue:</span> {workOrderData.reportedIssue}</p>
          </div>
          
          {/* Navigation Tabs */}
          <div className="flex bg-gray-200 border-b border-gray-300">
            <div 
              className={`px-4 py-2 font-semibold cursor-pointer ${activeTab === "resources" ? "bg-white border-t-2 border-blue-600" : "text-gray-600 hover:bg-gray-300"}`}
              onClick={() => handleTabClick("resources")}
            >
              Resources
            </div>
            <div 
              className={`px-4 py-2 font-semibold cursor-pointer ${activeTab === "documentation" ? "bg-white border-t-2 border-blue-600" : "text-gray-600 hover:bg-gray-300"}`}
              onClick={() => handleTabClick("documentation")}
            >
              Documentation
            </div>
            <div 
              className={`px-4 py-2 font-semibold cursor-pointer ${activeTab === "notes" ? "bg-white border-t-2 border-blue-600" : "text-gray-600 hover:bg-gray-300"}`}
              onClick={() => handleTabClick("notes")}
            >
              Notes
            </div>
          </div>
          
          {/* Main Content Area */}
          <div className="flex flex-1 overflow-hidden">
            {/* Left Sidebar - Resource Categories */}
            <div className="w-64 bg-gray-800 text-white p-2 overflow-y-auto">
              <h2 className="text-lg font-semibold mb-2 px-2">Resource Categories</h2>
              <ul>
                {categories.map(category => (
                  <li 
                    key={category}
                    className={`mb-1 rounded p-2 cursor-pointer ${selectedCategory === category ? 'bg-blue-700 font-semibold' : 'hover:bg-gray-700'}`}
                    onClick={() => handleCategoryClick(category)}
                  >
                    {category}
                  </li>
                ))}
              </ul>
              
              <div className="mt-6 px-2">
                <h3 className="text-sm font-semibold mb-2">Related Repairs</h3>
                <ul className="text-sm">
                  <li className="mb-1 text-blue-300 hover:underline cursor-pointer" onClick={() => alert("Opening Battery Disconnection Procedure")}>Battery Disconnection Procedure</li>
                  <li className="mb-1 text-blue-300 hover:underline cursor-pointer" onClick={() => alert("Opening Drivetrain Alignment Check")}>Drivetrain Alignment Check</li>
                  <li className="mb-1 text-blue-300 hover:underline cursor-pointer" onClick={() => alert("Opening Torque Specifications")}>Torque Specifications</li>
                </ul>
              </div>
            </div>
            
            {/* Main Content - Resource Viewer */}
            <div className="flex-1 p-4 overflow-y-auto">
              {activeTab === "resources" && <ResourcesContent />}
              {activeTab === "documentation" && <DocumentationContent />}
              {activeTab === "notes" && <NotesContent />}
            </div>
          </div>
        </div>
      );
    };

    // Render the component
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<TechnicianPortal />);
  </script>
</body>
</html>